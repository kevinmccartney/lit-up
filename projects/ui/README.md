# Lit Up UI

The frontend React application for the Lit Up music playlist platform. A modern, responsive web-based music player built with React, TypeScript, Vite, and Tailwind CSS.

## Features

- ğŸµ **Music Playback**: Full-featured audio player with play/pause, next/previous, and seek controls
- ğŸ“± **Responsive Design**: Optimized for both desktop and mobile devices
- ğŸ¨ **Theme Customization**: Multiple color themes with customizable primary, secondary, and tertiary colors
- ğŸ”„ **Auto-Advance**: Automatically plays the next track when the current one ends
- ğŸ“± **PWA Support**: Progressive Web App with install prompt and service worker
- ğŸ”’ **iOS Compatibility**: Concatenated playlist support for iOS lock screen auto-advance
- ğŸ **Easter Eggs**: Support for secret tracks hidden in the playlist
- ğŸ“¦ **Versioned Deployments**: Support for multiple versions of the app (v1, v2, etc.)
- ğŸ¯ **Track Library**: Browse and select tracks from a visual library with album art

## Tech Stack

- **React 18** - UI framework
- **TypeScript** - Type safety
- **Vite** - Build tool and dev server
- **Tailwind CSS 4** - Utility-first CSS framework
- **Radix UI** - Accessible component primitives
- **Lucide React** - Icon library

## Project Structure

```text
src/
â”œâ”€â”€ components/          # React components
â”‚   â”œâ”€â”€ MediaPlayer.tsx  # Main audio player component
â”‚   â”œâ”€â”€ MediaLibrary.tsx # Track library/browser
â”‚   â”œâ”€â”€ ThemePicker.tsx  # Theme selection UI
â”‚   â”œâ”€â”€ VersionPicker.tsx # Version selection
â”‚   â”œâ”€â”€ PWAInstallPrompt.tsx # PWA installation prompt
â”‚   â””â”€â”€ DevBuildInfo.tsx # Development build info
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ ThemeContext.tsx # Theme state management
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useTracks.ts     # Track data fetching and management
â”œâ”€â”€ App.tsx              # Main application component
â”œâ”€â”€ main.tsx             # Application entry point
â””â”€â”€ index.css            # Global styles
```

## Getting Started

### Prerequisites

- Node.js 18+ and npm
- The API scripts must be run first to generate `appConfig.json` and process songs

### Development

From the repository root:

```bash
# Start development server (also processes songs and generates config)
task ui:dev
```

The development server will start at `http://localhost:5173` (or the next available port).

### Building

From the repository root:

```bash
# Build for production
task ui:build
```

The built files will be output to `dist/` directory.

### Preview Production Build

From the repository root:

```bash
# Preview production build
task ui:preview
```

## Configuration

The UI reads its configuration from `appConfig.json`, which is generated by the API scripts from `lit_up_config.yaml`. The config includes:

- **tracks**: Array of track objects with metadata (id, title, artist, duration, cover art, etc.)
- **headerMessage**: Optional header message displayed at the top
- **concatenatedPlaylist**: Optional concatenated playlist for iOS compatibility
- **buildDatetime**: Build timestamp
- **buildHash**: Unique build identifier

## Versioning

The app supports versioned deployments via the `VERSION` environment variable. This allows multiple versions of the app to coexist (e.g., `/v1/`, `/v2/`). The base URL is automatically configured in `vite.config.ts`.

To build a specific version:

```bash
VERSION=v2 task ui:build
```

## Features in Detail

### Theme System

The app includes a flexible theme system with multiple predefined themes. Users can switch themes via the settings menu. Themes are managed through `ThemeContext` and can be customized in `src/contexts/ThemeContext.tsx`.

### Concatenated Playlist

For iOS devices, the app can use a concatenated playlist file that allows auto-advance to work properly when the device is locked. This is handled automatically if `concatenatedPlaylist` is present in the config.

### Secret Tracks

Tracks marked with `isSecret: true` in the config are hidden from the main library but can be accessed through special interactions (easter eggs).

### PWA Support

The app is configured as a Progressive Web App with:

- Service worker for offline support
- Web app manifest
- Install prompt for supported browsers

## Deployment

Deployment is handled via the root `taskfile.yaml`:

```bash
task ui:deploy
```

This will:

1. Process songs (if needed)
2. Generate configuration
3. Concatenate playlist
4. Generate favicon
5. Build the UI
6. Deploy to S3
7. Invalidate CloudFront cache

## Development Notes

- The app uses Vite's base URL configuration for versioned deployments
- All asset paths are automatically prefixed with the base URL
- The service worker is configured in `public/sw.js`
- Build info is displayed in development mode via `DevBuildInfo` component

## Scripts

- `npm run dev` - Start development server
- `npm run build` - Build for production
- `npm run preview` - Preview production build
- `npm run typecheck` - Run TypeScript type checking

## Dependencies

See `package.json` for the complete list of dependencies. Key dependencies:

- `react` & `react-dom` - React framework
- `@radix-ui/react-dropdown-menu` - Accessible dropdown menu
- `lucide-react` - Icon library
- `classnames` - Conditional class name utility
- `tailwindcss` - CSS framework
- `vite` - Build tool
